---
- name: Install postgresql server
  yum:
    name:
      - postgresql-server
    state: present
  notify: 
    - Initialize postgres db
    - Start and enable postgresql service.

- name: Install packages - epel-release
  yum:
    name:
      - epel-release
    state: present

- name: Install python-pip and python-psycopg2
  yum:
    name:
      - python-pip
      - python-psycopg2
    state: present

- name: Install psycopg2-binary pip package
  pip:
    name: psycopg2-binary

- meta: flush_handlers

- name: Add postgres user with password.
  become_user: postgres
  postgresql_user:
    name: user1
    password: password1

- name: Create postgres database flaskrdb
  become_user: postgres
  postgresql_db:
    name: flaskrdb
